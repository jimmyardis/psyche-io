<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Unified Cosmic Psyche v5: 3D Quantum Orbits</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body { margin: 0; background-color: #020617; color: white; overflow: hidden; font-family: ui-sans-serif, system-ui, sans-serif; }
        .tab-btn { padding: 0.5rem 1rem; border-bottom: 2px solid transparent; transition: all 0.2s; cursor: pointer; color: #94a3b8; }
        .tab-btn.active { border-bottom-color: #6366f1; color: white; }
        
        /* Cosmic Macros */
        @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .accretion-disk { animation: spin-slow 4s linear infinite; }
        
        /* 3D Quantum Micro Orbits */
        @keyframes orbit-path {
            from { transform: rotateZ(0deg); }
            to { transform: rotateZ(360deg); }
        }
        
        /* Counter-rotate the label so it doesn't spin upside down in 3D space */
        @keyframes counter-rotate {
            from { transform: rotateZ(360deg) rotateX(-90deg); }
            to { transform: rotateZ(0deg) rotateX(-90deg); }
        }

        .orbit-ring {
            position: absolute;
            top: 50%; left: 50%;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.15);
            transform-style: preserve-3d;
        }

        .satellite-carrier {
            position: absolute;
            inset: 0;
            border-radius: 50%;
            transform-style: preserve-3d;
        }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- DATA ARCHITECTURE ---
        const systemData = {
            blackHoles: [{ id: 'bh1', name: 'The Void (Addiction Singularity)', x: window.innerWidth - 200, y: window.innerHeight - 200, radius: 60, color: '#1e1b4b', eventHorizon: 100 }],
            wormholes: [{ id: 'w1', name: 'Instant Gratification', inX: 200, inY: window.innerHeight - 150, outX: window.innerWidth - 300, outY: window.innerHeight - 250, color: '#22d3ee' }],
            memeplexes: [{ id: 'm1', name: 'Spiritual/Meaning Framework', x: 250, y: 200, color: '#fcd34d', radius: 180 }],
            
            parts: [
                { id: 'p0', name: 'THE SELF', x: window.innerWidth/2, y: window.innerHeight/2, vx: 0, vy: 0, color: '#ffffff', isSelf: true, satellites: [] },
                { id: 'p1', name: 'The Manager', x: window.innerWidth/2, y: window.innerHeight/2 - 150, vx: 0, vy: 0, color: '#60a5fa', satellites: ['Scheduling Part', 'Control Part', 'Future-Casting', 'Anxiety Part', 'To-Do Lists', 'Fixing Part'] },
                { id: 'p2', name: 'The Critic', x: window.innerWidth/2 + 130, y: window.innerHeight/2 - 75, vx: 0, vy: 0, color: '#f472b6', satellites: ['Self-Doubt Part', 'Comparison', 'Shaming Part', 'Perfectionism', 'Guilt Trip', 'Evaluation'] },
                { id: 'p3', name: 'The Seeker', x: window.innerWidth/2 + 130, y: window.innerHeight/2 + 75, vx: 0, vy: 0, color: '#4ade80', satellites: ['Craving Part', 'Impulse Buying', 'Dopamine Hunt', 'Restlessness', 'Bargaining', 'Tunnel Vision'] },
                { id: 'p4', name: 'The Firefighter', x: window.innerWidth/2, y: window.innerHeight/2 + 150, vx: 0, vy: 0, color: '#f87171', satellites: ['Numbing Part', 'Dissociation', 'Bingeing Part', 'Distraction', 'Escapism', 'Urgency Part'] },
                { id: 'p5', name: 'The Exile', x: window.innerWidth/2 - 130, y: window.innerHeight/2 + 75, vx: 0, vy: 0, color: '#a78bfa', satellites: ['Fear Part', 'Worthlessness', 'Tears', 'Isolation Part', 'Flashbacks', 'Despair Part'] },
                { id: 'p6', name: 'The Mystic', x: window.innerWidth/2 - 130, y: window.innerHeight/2 - 75, vx: 0, vy: 0, color: '#fb923c', satellites: ['Awe Part', 'Connection', 'Artistic Part', 'Meaning-Making', 'Flow State', 'Intuition Part'] }
            ],
            
            spokeDist: 180,
            rimDist: 180,
            orbitRadius: 110, // Wider for 3D rings
            springLinks: [
                { source: 'p0', target: 'p1', type: 'spoke' }, { source: 'p0', target: 'p2', type: 'spoke' },
                { source: 'p0', target: 'p3', type: 'spoke' }, { source: 'p0', target: 'p4', type: 'spoke' },
                { source: 'p0', target: 'p5', type: 'spoke' }, { source: 'p0', target: 'p6', type: 'spoke' },
                { source: 'p1', target: 'p2', type: 'rim' }, { source: 'p2', target: 'p3', type: 'rim' },
                { source: 'p3', target: 'p4', type: 'rim' }, { source: 'p4', target: 'p5', type: 'rim' },
                { source: 'p5', target: 'p6', type: 'rim' }, { source: 'p6', target: 'p1', type: 'rim' }
            ]
        };

        const CosmicCanvas = () => {
            const [parts, setParts] = useState(systemData.parts);
            const requestRef = useRef();

            const updatePhysics = () => {
                setParts(currentParts => {
                    return currentParts.map(part => {
                        if (part.isDragging) return part;
                        let { x, y, vx, vy } = part;

                        // 1. SPRING PHYSICS
                        systemData.springLinks.forEach(link => {
                            let other = null;
                            if (link.source === part.id) other = currentParts.find(p => p.id === link.target);
                            if (link.target === part.id) other = currentParts.find(p => p.id === link.source);
                            
                            if (other) {
                                const dx = other.x - x; 
                                const dy = other.y - y;
                                const dist = Math.sqrt(dx*dx + dy*dy);
                                const targetDist = link.type === 'spoke' ? systemData.spokeDist : systemData.rimDist;
                                
                                if (dist > 0) {
                                    const diff = dist - targetDist;
                                    const force = diff * 0.003;
                                    vx += (dx / dist) * force;
                                    vy += (dy / dist) * force;
                                }
                            }
                        });

                        // 2. BLACK HOLE GRAVITY
                        systemData.blackHoles.forEach(bh => {
                            const dx = bh.x - x; const dy = bh.y - y;
                            const dist = Math.sqrt(dx*dx + dy*dy);
                            if (dist < bh.eventHorizon) {
                                vx += dx * 0.08; vy += dy * 0.08; 
                            } else if (dist < 400 && !part.isSelf) {
                                const force = (dx * 0.8) / (dist * 0.05) * 0.0015;
                                vx += force;
                                vy += (dy * 0.8) / (dist * 0.05) * 0.0015;
                            }
                        });

                        // 3. CENTER ANCHOR
                        if (part.isSelf) {
                            const cx = window.innerWidth / 2;
                            const cy = window.innerHeight / 2;
                            vx += (cx - x) * 0.05;
                            vy += (cy - y) * 0.05;
                        }

                        vx *= 0.92; vy *= 0.92;
                        return { ...part, x: x + vx, y: y + vy, vx, vy };
                    });
                });
                requestRef.current = requestAnimationFrame(updatePhysics);
            };

            useEffect(() => {
                requestRef.current = requestAnimationFrame(updatePhysics);
                return () => cancelAnimationFrame(requestRef.current);
            }, []);

            const handleDragStart = (id, e) => {
                setParts(prev => prev.map(p => p.id === id ? { ...p, isDragging: true } : p));
                const handleMouseMove = (ev) => setParts(prev => prev.map(p => p.id === id ? { ...p, x: ev.clientX, y: ev.clientY, vx: 0, vy: 0 } : p));
                const handleMouseUp = () => {
                    setParts(prev => prev.map(p => p.id === id ? { ...p, isDragging: false } : p));
                    window.removeEventListener('mousemove', handleMouseMove);
                    window.removeEventListener('mouseup', handleMouseUp);
                };
                window.addEventListener('mousemove', handleMouseMove);
                window.addEventListener('mouseup', handleMouseUp);
            };

            return (
                <div className="relative w-full h-full overflow-hidden select-none">
                    <svg className="absolute inset-0 w-full h-full pointer-events-none">
                        <rect width="100%" height="100%" fill="#020617" />
                        
                        {/* Background Entities */}
                        {systemData.blackHoles.map(bh => (
                            <g key={bh.id}>
                                <circle cx={bh.x} cy={bh.y} r={bh.radius * 2} fill={`url(#grad-${bh.id})`} opacity="0.6" className="accretion-disk"/>
                                <circle cx={bh.x} cy={bh.y} r={bh.radius} fill="black" stroke={bh.color} strokeWidth="2" />
                                <defs><radialGradient id={`grad-${bh.id}`}><stop offset="30%" stopColor="black" /><stop offset="70%" stopColor={bh.color} /><stop offset="100%" stopColor="transparent" /></radialGradient></defs>
                                <text x={bh.x} y={bh.y} textAnchor="middle" fill="white" fontSize="10" opacity="0.5">THE VOID</text>
                            </g>
                        ))}

                        {/* Macro-Spokes (Self to Parts & Part to Part) */}
                        {systemData.springLinks.map((link, i) => {
                            const s = parts.find(p => p.id === link.source);
                            const t = parts.find(p => p.id === link.target);
                            if (!s || !t) return null;
                            const isSpoke = link.type === 'spoke';
                            return <line key={`macro-${i}`} x1={s.x} y1={s.y} x2={t.x} y2={t.y} 
                                stroke={isSpoke ? "rgba(255,255,255,0.3)" : "rgba(255,255,255,0.1)"} 
                                strokeWidth={isSpoke ? "2" : "1"} 
                                strokeDasharray={isSpoke ? "none" : "5,5"} 
                            />;
                        })}
                    </svg>

                    {/* Nodes (Parts & Self) */}
                    {parts.map(part => {
                        return (
                            <div key={part.id} 
                                onMouseDown={(e) => handleDragStart(part.id, e)}
                                className={`absolute transform -translate-x-1/2 -translate-y-1/2 cursor-grab active:cursor-grabbing ${part.isSelf ? 'z-30' : 'z-20'}`}
                                style={{ 
                                    left: part.x, top: part.y,
                                    perspective: '1000px', // Creates the 3D depth field for this specific node
                                    transformStyle: 'preserve-3d'
                                }}
                            >
                                {/* Core Nucleus */}
                                <div className={`absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 rounded-full shadow-[0_0_20px_rgba(255,255,255,0.2)] z-20
                                     ${part.isSelf ? 'w-16 h-16 bg-white shadow-[0_0_30px_rgba(255,255,255,0.8)]' : 'w-12 h-12'}`}
                                     style={{ backgroundColor: part.color }}>
                                     {part.isSelf && <div className="w-full h-full flex items-center justify-center text-black font-bold text-xs">SELF</div>}
                                </div>
                                
                                {/* 3D Orbiting Rings & Satellites */}
                                {!part.isSelf && part.satellites.map((meme, index) => {
                                    // Calculate the tilt of the ring in 3D space. 6 satellites = 6 rings intersecting at the core.
                                    const tilt = index * (180 / part.satellites.length); 
                                    // Varying orbital speeds to make it look organic
                                    const orbitDuration = 6 + (index % 3); 
                                    
                                    return (
                                        <div key={index} className="orbit-ring" 
                                            style={{ 
                                                width: `${systemData.orbitRadius}px`, 
                                                height: `${systemData.orbitRadius}px`,
                                                marginTop: `-${systemData.orbitRadius/2}px`, 
                                                marginLeft: `-${systemData.orbitRadius/2}px`,
                                                transform: `rotateX(70deg) rotateY(${tilt}deg)` 
                                            }}
                                        >
                                            {/* The Carrier dictates the spin around the ring */}
                                            <div className="satellite-carrier" style={{ animation: `orbit-path ${orbitDuration}s linear infinite` }}>
                                                
                                                {/* The actual dot sitting on the edge of the ring */}
                                                <div className="absolute top-0 left-1/2 w-4 h-4 -ml-2 -mt-2 bg-slate-900 border border-slate-400 rounded-full flex items-center justify-center group shadow-lg"
                                                     style={{ transformStyle: 'preserve-3d' }}>
                                                    
                                                    <div className="w-1.5 h-1.5 rounded-full" style={{ backgroundColor: part.color, opacity: 0.8 }}></div>
                                                    
                                                    {/* The Label counter-rotates so it stays readable while orbiting in 3D */}
                                                    <div className="hidden group-hover:block absolute -top-8 text-[10px] bg-black/90 text-white px-2 py-0.5 rounded whitespace-nowrap z-50 border border-slate-700"
                                                         style={{ animation: `counter-rotate ${orbitDuration}s linear infinite` }}>
                                                        {meme}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    )
                                })}

                                {!part.isSelf && (
                                    <div className="absolute top-[80px] left-1/2 -translate-x-1/2 text-xs font-bold text-slate-200 whitespace-nowrap bg-slate-900/90 px-3 py-1 rounded-full border border-slate-700 z-30">
                                        {part.name}
                                    </div>
                                )}
                            </div>
                        )
                    })}
                </div>
            );
        };

        const SchemaView = () => (
            <div className="p-8 h-full overflow-y-auto bg-slate-900">
                <h2 className="text-xl font-bold mb-6 text-indigo-400">The Fractal Architecture: 3D Quantum Topology</h2>
                <div className="space-y-6 max-w-4xl">
                    <div className="bg-slate-800 p-6 rounded-lg border border-slate-700">
                        <h3 className="text-xl font-bold text-white mb-2">Tier 1: The Central Sun (Self)</h3>
                        <p className="text-slate-400 mb-4">Pure consciousness. It acts as the anchor holding the entire 2D macro-network in balance.</p>
                    </div>
                    <div className="bg-slate-800 p-6 rounded-lg border border-slate-700 ml-8">
                        <h3 className="text-lg font-bold text-indigo-400 mb-2">Tier 2: The 6 Planets (Major Parts)</h3>
                        <p className="text-slate-400 mb-4">Orbiting the Self on a 2D plane are the 6 primary subpersonalities. They handle the macro-level physics of addiction and survival.</p>
                    </div>
                    <div className="bg-slate-800 p-6 rounded-lg border border-slate-700 ml-16">
                        <h3 className="text-md font-bold text-emerald-400 mb-2">Tier 3: The Quantum Electron Cloud (Micro Orbits)</h3>
                        <p className="text-slate-400 mb-4">Zooming in, every Major Part has a Z-Axis depth field. The 6 sub-parts rotate along interlocking, tilted 3D orbital rings‚Äîmimicking the electron probability clouds of an atom.</p>
                    </div>
                </div>
            </div>
        );

        const MindMapView = () => (
            <div className="p-8 h-full flex flex-col items-center justify-start overflow-auto bg-slate-900 pt-20">
                <div className="bg-white text-black px-8 py-4 rounded-full font-bold shadow-[0_0_30px_rgba(255,255,255,0.4)] z-10 text-xl border-4 border-indigo-500">
                    THE SELF
                </div>
                <div className="w-px h-12 bg-slate-500"></div>
                <div className="flex gap-12 relative px-12">
                    <div className="absolute top-0 left-[5%] right-[5%] h-px bg-slate-500"></div>
                    {systemData.parts.filter(p => !p.isSelf).map(part => (
                        <div key={part.id} className="flex flex-col items-center relative pt-6">
                            <div className="w-px h-6 bg-slate-500 absolute top-0"></div>
                            <div className="bg-slate-800 border-2 px-4 py-2 rounded-lg text-sm font-bold z-10 mb-6 whitespace-nowrap shadow-lg" style={{ borderColor: part.color }}>
                                {part.name}
                            </div>
                            <div className="flex flex-col gap-3 pl-4 border-l-2 border-slate-700">
                                {part.satellites.map((meme, i) => (
                                    <div key={i} className="flex items-center text-xs text-slate-300">
                                        <div className="w-4 h-px bg-slate-700 mr-2"></div>
                                        <span className="bg-slate-950 px-2 py-1 rounded border border-slate-800">{meme}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );

        const App = () => {
            const [activeTab, setActiveTab] = useState('canvas');
            return (
                <div className="flex flex-col h-screen">
                    <div className="bg-slate-950 border-b border-slate-800 p-4 flex justify-between items-center">
                        <div className="flex items-center gap-3">
                            <span className="text-2xl">üîÆ</span>
                            <h1 className="text-xl font-bold tracking-tight">Psyche-OS <span className="text-slate-500 text-sm font-normal">v5.0 3D Quantum Orbits</span></h1>
                        </div>
                        <div className="flex gap-2">
                            <button className={`flex items-center gap-2 tab-btn ${activeTab === 'canvas' ? 'active' : ''}`} onClick={() => setActiveTab('canvas')}>‚öõÔ∏è Canvas</button>
                            <button className={`flex items-center gap-2 tab-btn ${activeTab === 'schema' ? 'active' : ''}`} onClick={() => setActiveTab('schema')}>üóÑÔ∏è Schema</button>
                            <button className={`flex items-center gap-2 tab-btn ${activeTab === 'mindmap' ? 'active' : ''}`} onClick={() => setActiveTab('mindmap')}>üß† Hierarchy</button>
                        </div>
                    </div>
                    <div className="flex-1 relative">
                        {activeTab === 'canvas' && <CosmicCanvas />}
                        {activeTab === 'schema' && <SchemaView />}
                        {activeTab === 'mindmap' && <MindMapView />}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
